<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{{ .Title }}</title>
        <style>
            /* --- RESET & BASIC SETUP --- */
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body, html {
                height: 100%;
                width: 100%;
                overflow: hidden;
                background: #000;
                font-family: sans-serif;
            }

            /* --- NAVIGATION BUTTON --- */
            #top-btn {
                position: absolute;
                top: 20px;
                right: 20px;
                z-index: 100;
                cursor: pointer;
                background: rgba(0,0,0,0.5);
                padding: 10px;
                border-radius: 50%;
                display: flex;
                justify-content: center;
                align-items: center;
                transition: transform 0.2s, background 0.2s;
            }
            #top-btn:hover {
                transform: scale(1.1);
                background: rgba(0,0,0,0.8);
            }

            /* --- BACKGROUND SLIDESHOW --- */
            #bg-container {
                position: absolute;
                top: -5%;
                left: -5%;
                width: 110%;
                height: 110%;
                z-index: 1;
            }
            .bg-img {
                position: absolute;
                top: 0; left: 0;
                width: 100%; height: 100%;
                background-size: cover;
                background-position: center;
                opacity: 0;
                animation: fadeLoop 18s infinite;
            }
            .bg-img:nth-child(1) { animation-delay: 0s; }
            .bg-img:nth-child(2) { animation-delay: 6s; }
            .bg-img:nth-child(3) { animation-delay: 12s; }

            @keyframes fadeLoop {
                0% { opacity: 0; } 10% { opacity: 1; } 33% { opacity: 1; } 43% { opacity: 0; } 100% { opacity: 0; }
            }

            /* --- CENTER STAGE --- */
            #center-stage {
                position: relative;
                z-index: 10;
                height: 100%;
                width: 100%;
                display: flex;
                justify-content: center;
                align-items: center;
                pointer-events: none;
            }

            .cloud-wrapper {
                position: relative;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                cursor: pointer;
                pointer-events: auto;
                text-decoration: none;
            }

            /* --- IMAGE STYLES --- */
            .center-img {
                width: 100%;
                height: auto;
                display: block;
                /* Use Variables for Initial State */
                transform: translate(var(--move-x), var(--move-y));
                opacity: var(--base-op);
                transition: opacity 0.3s ease;
            }

            /* --- ANIMATION LOGIC --- */

            /* 1. Image Animation (Respects Position) */
            .cloud-wrapper:hover .center-img {
                animation: imagePop 0.4s forwards;
            }

            @keyframes imagePop {
                from {
                    /* Start at current custom opacity and position */
                    opacity: var(--base-op);
                    transform: translate(var(--move-x), var(--move-y)) scale(1);
                }
                to {
                    /* Go to full opacity and scaled up, KEEPING position */
                    opacity: 1;
                    transform: translate(var(--move-x), var(--move-y)) scale(1.05);
                }
            }

            /* 2. Text Animation (Simple Scale) */
            .cloud-wrapper:hover .content-hover {
                display: block;
                animation: textPop 0.4s forwards;
            }

            @keyframes textPop {
                from { opacity: 0; transform: scale(0.95); }
                to { opacity: 1; transform: scale(1.05); }
            }

            /* --- TEXT STYLES --- */
            .cloud-text {
                position: absolute;
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                text-align: center;
                z-index: 2;
                pointer-events: none;
            }

            .content-default { display: block; transition: opacity 0.3s ease; }
            .content-hover { display: none; opacity: 0; }

            .cloud-wrapper:hover .content-default { display: none; }

            h1 { font-size: 1.8rem; margin-bottom: 0.3rem; font-weight: 700; letter-spacing: 1px; }
            p { font-size: 1rem; font-weight: 300; opacity: 0.9; }
            .hover-text { font-size: 1.3rem; font-weight: 500; letter-spacing: 2px; }

        </style>
    </head>
    <body>

        <a href="{{ if .IsHome }}/summer-sale/{{ else }}/{{ end }}" id="top-btn">
            {{ if .IsHome }}
                <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0 9c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.93c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0l-1.42 1.42c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0l1.42-1.42zm13.31 13.31c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0l-1.42 1.42c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0l1.42-1.42zM4.93 19.07c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-1.42 1.42c-.39.39-1.02.39-1.41 0-.39-.39-.39-1.02 0-1.41l1.42-1.42zm13.31-13.31c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41l-1.42-1.42c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41l1.42 1.42z"/></svg>
            {{ else }}
                <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
            {{ end }}
        </a>

        <div id="bg-container">
            {{ range .Params.background_images }}
                {{ $path := strings.TrimPrefix "/" . }}

                {{ $img := resources.Get $path }}

                {{ if $img }}
                    {{ $final := $img.Resize "1920x webp" }}
                    <div class="bg-img" style="background-image: url('{{ $final.RelPermalink }}');"></div>
                {{ else }}
                    <div class="bg-img" style="background-image: url('{{ . }}');"></div>
                {{ end }}
            {{ end }}
        </div>

        <div id="center-stage">
            <a href="/products"
               class="cloud-wrapper"
               style="width: {{ .Params.img_width | default "380px" }};">

                <img src="{{ .Params.center_image }}"
                     alt="Center Logo"
                     class="center-img"
                     style="
                       --move-x: {{ .Params.pos_x | default "0px" }};
                       --move-y: {{ .Params.pos_y | default "0px" }};
                       --base-op: {{ .Params.img_opacity | default "0.9" }};
                     ">

                <div class="cloud-text" style="color: {{ .Params.text_color | default "white" }};">
                    <div class="content-default">
                        <h1>{{ .Title }}</h1>
                        <p>{{ .Params.subtitle }}</p>
                    </div>
                    <div class="content-hover">
                        <h1>{{ .Title }}</h1>
                        <span class="hover-text">Made With Love</span>
                    </div>
                </div>
            </a>
        </div>

        <script>
            const bg = document.getElementById("bg-container");
            document.addEventListener("mousemove", (e) => {
                const x = e.clientX / window.innerWidth;
                const y = e.clientY / window.innerHeight;
                const moveX = -3 + x * 6;
                const moveY = -3 + y * 6;
                bg.style.transform = `translate(${moveX}%, ${moveY}%)`;
            });
        </script>
    </body>
</html>
